sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/m/MessageToast","sap/ui/core/Fragment","../model/models"],(e,t,o,n,i)=>{"use strict";return e.extend("employeemanagement.controller.OverviewPage",{onInit(){const e=this.getView();const t=this.getOwnerComponent().getModel("userLoginModel");const o=Object.keys(t.getData().roles||{});if(!o.includes("Admin")){this.byId("actionColumn")?.setVisible(false);this.byId("_IDGenHBox2")?.setVisible(false);this.byId("_IDGenColumnListItem").setType("Inactive")}const n=e.getModel("MasterDataModel");if(!n){setTimeout(()=>this.onInit(),100);return}const i=n.getData();const l=JSON.parse(JSON.stringify(i.roles||[]));const s=JSON.parse(JSON.stringify(i.departments||[]));l.unshift({ID:"All",name:"All"});s.unshift({ID:"All",name:"All"});const r=new sap.ui.model.json.JSONModel({roles:l,departments:s,selectedRole:"All",selectedDepartment:"All"});e.setModel(r,"FilterModel")},onItemPress:function(e){const t=this.getOwnerComponent().getRouter();const o=e.getSource();const n=o.getBindingContext("EmployeeModel");if(!n){console.error("No binding context found for EmployeeModel");return}const i=n.getObject();if(!i||!i.ID){console.error("Employee ID not found");return}t.navTo("DetailEmployee",{id:i.ID})},onInputForm:function(e){const t=this.getOwnerComponent().getRouter();t.navTo("CreateEmployee")},onEmpList:function(e){const t=this.getOwnerComponent().getRouter();t.navTo("OverviewPage")},onMasterData:function(){const e=this.getOwnerComponent().getRouter();e.navTo("MasterDataPage")},onDeleteEmployeePress:function(e){this._oDeleteContext=e.getSource().getParent().getBindingContext("EmployeeModel");this._openConfirmDialog({title:"Confirm Delete Employee",message:"Are you sure you want to delete this employee?",state:"Information",confirmText:"Delete",cancelText:"Cancel"})},_openConfirmDialog:function(e){if(!this._oConfirmDialog){n.load({id:this.getView().getId(),name:"employeemanagement.view.fragment.ConfirmDialog",controller:this}).then(function(t){this._oConfirmDialog=t;this.getView().addDependent(this._oConfirmDialog);this._setDialogProperties(e);t.open()}.bind(this))}else{this._setDialogProperties(e);this._oConfirmDialog.open()}},_setDialogProperties:function(e){const t=new sap.ui.model.json.JSONModel({dialogTitle:e.title,dialogMessage:e.message,dialogState:e.state,confirmText:e.confirmText,cancelText:e.cancelText});this._oConfirmDialog.setModel(t,"dialog")},onConfirm:async function(){if(!this._oDeleteContext){t.error("No employee selected for deletion.");this._oConfirmDialog.close();return}const e=this.getView().getModel("EmployeeModel");let n=this._oDeleteContext.getPath();let i=e.getGroupId();try{const t=await e.delete(n,i,true);o.show("Employee deleted successfully.");this._oConfirmDialog.close()}catch(e){console.error("Delete failed",e);sap.m.MessageBox.error("Failed to delete employee.");this._oConfirmDialog.close()}},onCancel:function(){o.show("Delete canceled");this._oConfirmDialog.close()},onFilterChange:function(){const e=this.getView();const t=e.byId("employeeTable");const o=e.getModel("FilterModel");console.log(o);const n=e.byId("levelFilter").getSelectedKey();const i=e.byId("levelFilter2").getSelectedKey();const l=[];if(n&&n!=="All"){l.push(new sap.ui.model.Filter("role_ID","EQ",n))}if(i&&i!=="All"){l.push(new sap.ui.model.Filter("department_ID","EQ",i))}const s=t.getBinding("items");if(s){s.filter(l)}}})});
//# sourceMappingURL=OverviewPage.controller.js.map